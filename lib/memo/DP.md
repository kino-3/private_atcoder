# DP

## 問題

- 並べた 2N 個の要素のペアリングの作る手順の場合の数(同じ結果でも作る順番が違えば区別される)
- 制約: ペアリングがクロスしない
  - OK: AABB, ABBA
  - NG: ABAB

## 解法

- 区間DP: dp[l][n] = [l, l+2n) の部分の結果
- l とペアになる k は l+1, l+3, ..., l + 2i - 1, ..., l+2n-1
- 手順では [l, k], [k+1, r) の群のどちらかを選んでペアを1つつくることを繰り返すので, nCi
- dp[l][r] = Σ_k (dp[l+1][k] * dp[k+1][r] * nCi)

## 参考問題

- [問題](https://atcoder.jp/contests/abc217/tasks/abc217_f)

## 問題

- 並べた N 個の整数の [L, R] の和が 0 となる (L, R) の組について O(N log N)
- (和が K となる区間の判定なども同様)

## 解法

map の key を累積和とする

- v: [1, R] の累積和
- map[v]: そのときの R のリストなど
  - map[v] が空でないとき, 再び累積和が v となったなら区間和が 0 となっている
- 例: 累積和が 1, 4, 5, 10, 7 のとき, 次の累積和が 5 なら {5, 10, 7 , 5} に相当する区間の和は 0

## 参考問題

- [問題](https://atcoder.jp/contests/abc230/tasks/abc230_f)

## 部分列DP

文字列 S の部分文字列は何種類あるか?
文字列の種類数を K として O(KN)

## 解法

- 部分文字列のうち, 重複するものは index が最も左のものを採用する
- dp[i]: i 文字目を使う場合の S[0:i] の部分文字列の種類数
- 初期条件 dp[0] = 1
- 答: Σdp[j]
- 解法1: 配るDP
  - 前計算: next[i][c] S の i 文字目以降で最初に c が出現する index
  - 遷移式(配るDP): dp[next[i][c]] += dp[i] (all c)
- 解法2: 貰うDP
  - k を S[k] == S[i] かつ k < i を満たす最大の k とする
  - どの文字までの部分文字列に S[i] をつなげるとよいか?
    - k-1文字目まで: S[i] ではなく S[k] をつなげるべき
    - k文字目以降: dp[j] を全て足す

- 参考問題で提出したコードは
  - 貰う DP
  - 重複するものは index が最も右のものを採用する
    - prev[c] 現時点で最も右にある c の idx

## 参考問題

- [問題](https://atcoder.jp/contests/abc214/tasks/abc214_f)

## 問題

- 順列問題一般に使える
- N 要素の最善な swap 操作を得る
- O(N!) ではなく O(2^N) で行いたい

## 解法

bitDP

### 一般の場合

- N 個から指定された i 個を選択して, それらを左寄せした結果を dp[S] とする。(S は bit で選ばれた i 個の要素を表す)
- dp[S] は以下で更新する
  - for k in S:
    - T = S\k とする
    - 左端は dp[T] のときの T で, その直後に k を付ける。
  - ループをもとに dp[S] を決定する
- ポイントは, `左端は dp[T] のときの T の並び` としてよいかどうかだと思う。
- dp[S] は dp[T] で決まるので, S = 0,1,2,... と順に決めて良い。

### 並び替えの場合

- N 個から指定された i 個を選択して, それらを(自由に並び替えて)左寄せした最善な結果を dp[S] とする。(S は bit で選ばれた i 個の要素を表す)
- dp[S] は以下で更新する
  - for k in S:
    - T = S\k とする
    - 左端は dp[T] のときの T の並びで, その直後に k を付ける。この時のコストを計算する
  - ループのコストを比較する
- ポイントは, `左端は dp[T] のときの T の並び` としてよいかどうかだと思う。
- dp[S] は dp[T] で決まるので, S = 0,1,2,... と順に決めて良い。

## 参考問題

- [問題](https://atcoder.jp/contests/abc232/tasks/abc232_f)
- [問題](https://atcoder.jp/contests/abc199/tasks/abc199_e)
