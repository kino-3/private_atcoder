# 整数

## 約数系包除原理

- g(k) = Σ_i f(i) (i は N 以下の k の倍数) が分かるときの, f(k) の時の答え
  - ちょうど k のときを f(k) = dp[k] とすると
  - dp[k] = g(k) - (dp[2k] + dp[3k] + ...)
  - k が大きい方から dp を確定する
  - 計算量は N/1 + N/2 + ... + N/N = O(NlogN)
- g(k) = Σ_i f(i) (i は N 以下の k の約数) が分かるときの, f(k) の時の答え
  - ちょうど k のときを f(k) = dp[k] とすると
  - dp[k] = g(k) - Σ_i dp[i] (i は k の約数)
  - k が小さい方から dp を確定する
  - 約数の個数はそれほど多くない
- メビウス関数 μ(i) を用いる
  - Σ μ(i)f(i) = f(2) + f(3) + f(5) - f(6) - f(10) - f(15) + f(30)
  - 計算自体は i = 2,3,4,... で μ(i)f(i) を足し合わせる
  - イメージとしては(倍数に着目した)全部の足し合わせ
    - (2 の倍数の場合) + (3 の倍数の場合) + ...
    - (6 の倍数の場合) は上で 2 重にカウントしているので係数 -1
    - (2^n3^m (12 など) の倍数の場合) は (6 の倍数の場合) に完全に含まれるので無視する
