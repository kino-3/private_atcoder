# 木の解法のメモ

## 最長経路(つまり, 木の直径) O(V)

### 問題

- 辺はコストを持つ
- 最も遠い2点の距離を求める

### 解法

1. 任意の点(X)から最も遠い点(A)を探索(BFSなど)する
2. A から最も遠い点(B)を探索(BFSなど)する

このとき, A-B が最長経路(の1つ)となる。

### 証明

任意の点(X)から最も遠い点がA'(≠A)とする。X を取り除いたとき, AとBが異なる部分木にあるなら, A'-B が A-B より長くなり矛盾。AとBが同じ部分木にあるなら, X で吊ったときのAとBのLCAをYとすると, A-Y よりも Y-X-A' の方が長く, A'-X-Y-B が A-Y-B より長くなり矛盾。

## 全始点最長経路 O(V)

### 問題

- 辺はコストを持つ
- 全ての点について, 自身から最も遠い点の距離を求める

### 解法

- 木の直径の 1 つを s-t とする
- 任意の点 u について, `max_v d(u,v) = max(d(u,s),d(u,t))` と求まる。

### 証明

最も遠い点を w と仮定したとき, u,s,t,w の位置関係で場合分け(省略)すると, 木の直径は d(s,w) または d(t,w) となる。

### 参考問題

- [問題](https://atcoder.jp/contests/abc222/tasks/abc222_f)
