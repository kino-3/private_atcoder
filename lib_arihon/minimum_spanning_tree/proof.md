# 最小全域木の証明

## 補題

> 全域木 T に T に含まれない任意の辺 e を足すと e を含む閉路ができ, この閉路から任意の 1 つの辺 e' を除くと全域木になる。

- 前半: 任意の 2 頂点は T に含まれる辺のみを経由して到達可能であるため, e の両端の 2 頂点をつなぐ経路は 2 つできる。
- 後半: この閉路に属する頂点の集合を A, その他の頂点の集合を B としたとき, e' を取り除く前は任意の B に属する点は閉路の辺を経由せずにいずれかの A の頂点に到達可能であり, これは e' を取り除いても影響を受けない。また, e' を取り除いたあとも A に属する任意の 2 頂点間は到達可能である。したがって, e' を取り除いても, 任意の 2 頂点間は到達可能である。また, e' を取り除いた後の辺の個数は (頂点数 - 1) である。以上のことから, e' を除くと全域木となる。

## Prim 法

> 任意の頂点について, その頂点を含む最小全域木が存在する。(自明)  
> 部分木 T を含む最小全域木が存在するとき, (部分木 T に含まれる頂点の集合を A, 含まれない頂点の集合を B として, A の要素と B の要素の間の辺の集合を E として, E の要素のうちコスト最小の辺を e_opt とすると, )部分木 T に e_opt を加えた部分木を含む最小全域木が存在する。(含まない最小全域木があるかもしれない)

「部分木 T に e_opt を加えた部分木を含む最小全域木が存在しない」と仮定する。このとき, 「部分木 T を含む最小全域木が存在する」ことと「その最小全域木には E の要素を少なくとも 1 つ含む」 (でないと A と B が連結ではないため, 木にならない) ことから, E の要素のうち e_opt ではない辺 e' を含む最小全域木が存在する。  
補題より, この最小全域木から e' を除いて e_opt を加えたものは全域木であり, e_opt のコストは e' のコスト以下であるから, これも最小全域木である。  
これは「部分木 T に e_opt を加えた部分木を含む最小全域木」であるため矛盾する。

## Kruskal 法

> 空集合の要素全てを含む最小全域木が存在する。(自明)  
> 辺の集合 E の要素全てを含む最小全域木が存在するとき, (E に含まれない辺 e のうち, E の要素と e で閉路が構成出来ない辺のうち, コスト最小の辺を e_opt とすると, ) 辺の集合 E の要素全てと e_opt を含む最小全域木が存在する。

「辺の集合 E の要素全てと e_opt を含む最小全域木が存在しない」と仮定する。このとき, 「辺の集合 E の要素全てを含む最小全域木」が存在して, それに e_opt を加えてできる閉路をなす辺の集合には, E の要素でも e_opt でもない辺 e' が含まれる。(もし含まれないと仮定すると, E の要素と e_opt で閉路が構成出来るため e_opt の定義に矛盾する。)  
ここで考えた最小全域木は E の要素と e' を含むため, e' は「E に含まれない辺 e のうち, E の要素と e で閉路が構成出来ない辺」であるため, e' のコストは e_opt 以上である。  
補題より, ここで考えた最小全域木に e_opt を加えて e' を取り除いたものは全域木で, コストの和は最小全域木以下であるからこれも最小全域木である。これは「辺の集合 E の要素全てと e_opt を含む最小全域木」であり矛盾する。
