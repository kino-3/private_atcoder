# セグメント木

## セグメント木(通常)

- データ数が m のとき, 次のように index を振る
  - N=2^n となる N を考える。(m <= N)
  - i (i=0,1,...,m-1)番目の葉ノードの index は N - 1 + i
  - 親ノードの index は (n-1)/2
  - 子ノードの index は 2n+1, 2n+2

```txt
[            0              ]
[     1     ][       2      ]
[  3 ][  4  ][  5   ][  6   ]
[7][8][9][10][11][12][13][14]
```

区間[l,r)の最小値を考える場合
(※[0,r)から[0,l)を取り除いて考えることは出来ない)

- 各 node はその区間の最小値をもつ
- 計算量
  - 初期化 O(n)
  - 値の更新 O(log n)
  - 区間の最小値 O(log n)

## Sparse Table

- T_i,j は index = i, i+1, ..., i+2^j-1 の最小値
- 計算量
  - 初期化 O(n log n)
  - 値の更新 不可能
  - 区間の最小値 O(log log n)

## Binary Indexed Tree

- 右ノードの値は計算に使わないため不要
- 1 から index を振る

```txt
[            8         ]
[     4     ]
[  2 ]      [  6 ]
[1]   [3]   [5]   [7]
```

- 各 node はその区間の和をもつ
- 計算量
  - 初期化 O(n)
  - 値の更新 O(log n)
  - 1 から k までの和 O(log n)

### TODO: 2次元の BIT

## 平方分割

- 計算量
  - 初期化 O(n)
  - 値の更新 O(√n)
  - 区間の最小値 O(√n)
